#### Approach

The goal is to implement part-of-speech tagging using Bayes network. We have used simplified Bayes net and Viterbi algorithm to assign part-of-speech to every word in a given sentence. [The article](https://www.mygreatlearning.com/blog/pos-tagging/), Part of Speech (POS) tagging with Hidden Markov Model helped us to understand and implement POS tagging.

The file, bc.train is used to train the data and every word with the corresponding part-of-speech (POS) are stored in a list to find the initial probability. Likelihood of a POS followed by all other POS, i.e., Transition probability is calculated using the function transition_probability by dividing the total number of transitions happened from POS1 to POS2 by total number of POS1. 

#### Simplified Bayes net <br>

Using Simplified Bayes net, the probability of every word belongs to a particular POS is calculated using emission probability in the function, emission_probability. Emission probability is calculated by dividing total number of times a word was found for a given label by the total number of counts for the given label in the dataset. Once the emission probability of every POS is known, the most probable POS tag is choosen for every word using the function, s*i = argmaxP(si = si|W), where si is POS and W is the word.

#### Hidden Markov Model – Viterbi algorithm <br>

In this model, the dependence of the words is also taken into consideration where the word also depends on the POS of the previous word in a sentence. Transition possibility of every POS is calculated using the function transition_probability and stored in the dataframe. For every first word in the sentence, the probability of the POS after ‘.’ is looked up in the dataframe. For all the other words, transition probability depends on the previous word’s POS. The emission probability is determined as by what percentage a word could belong to one particular POS. The probability of the state is calculated by multiplying transition probability with the emission probability. State with the maximum probability is chosen as the best POS tagger for a sentence.

#### Confidence <br>

To compute the confidence of the predicted POS, we've implemented the forward-backward algorithm using the pseudo code provided [in this Wikipedia article](https://en.wikipedia.org/wiki/Forward%E2%80%93backward_algorithm). The computation speed of backward part of the algorithm significantly more time to compute, nearly 10 minutes for the simple sentence 'at the same  instant, nick hit the barrel and threw himself upon the smaller man.' As the code take a significant amount of time to compute the confidence, we have provided a couple of outputs of our generated by the code :



| Simple     HMM at    the   same  instant ,     nick  hit   the   barrel and   threw himself upon  the   smaller man   .<br/>        0. Ground truth   -82.28 -108.77 adp   det   adj   noun    .     noun  verb  det   noun   conj  verb  pron    adp   det   adj     noun  .<br/>              1. Simple   -82.28 -108.77 adp   det   adj   noun    .     noun  verb  det   noun   conj  verb  pron    adp   det   adj     noun  .<br/>                 2. HMM   -82.28 -108.77 adp   det   adj   noun    .     noun  verb  det   noun   conj  verb  pron    adp   det   adj     noun  .<br/>          3. Confidence                  1.0   1.0   1.0   1.0 1.0   1.0   0.94 1.0   1.0    1.0   1.0   1.0     1.0   1.0   1.0     1.0 1.0<br/><br/>==> So far scored 1 sentences with 17 words.<br/>                   Words correct:     Sentences correct:<br/>   0. Ground truth:      100.00%              100.00%<br/>         1. Simple:      100.00%              100.00%<br/>            2. HMM:      100.00%              100.00% |
| :----------------------------------------------------------- |
| **Simple     HMM the   gun   fired next  to    his   ear   with  a     vicious whoosh like  the   first stroke of    an    old   steam engine .<br/>        0. Ground truth  -104.41 -135.29 det   noun  verb  adp   adp   det   noun  adp   det   adj     prt    adp   det   adj   noun   adp   det   adj   noun  noun   .<br/>              1. Simple   -99.45 -132.46 det   noun  verb  adj   prt   det   noun  adp   det   adj     verb   adp   det   adj   noun   adp   det   adj   noun  noun   .<br/>                 2. HMM   -99.45 -132.46 det   noun  verb  adj   prt   det   noun  adp   det   adj     verb   adp   det   adj   noun   adp   det   adj   noun  noun   .<br/>          3. Confidence                  nan   nan   nan   nan   nan   nan   nan   nan   nan   nan     nan    nan   nan   nan   nan    nan   nan   nan   nan   nan    nan<br/><br/>==> So far scored 2 sentences with 38 words.<br/>                   Words correct:     Sentences correct:<br/>   0. Ground truth:      100.00%              100.00%<br/>         1. Simple:       92.11%               50.00%<br/>            2. HMM:       92.11%               50.00%** |
| **Simple     HMM at    the   same  instant ,     elaine screamed wildly ,     the   sound ending abruptly as    nick  went  off   the   boat  and   into  the   water on    top  <br/> of    the   frantic ,     struggling poet  .<br/>        0. Ground truth  -166.84 -216.60 adp   det   adj   noun    .     noun   verb     adv    .     det   noun  verb   adv      adp   noun  verb  adp   det   noun  conj  adp   det   noun  adp   noun <br/> adp   det   adj     .     verb       noun  .<br/>              1. Simple  -162.68 -220.47 adp   det   adj   noun    .     noun   verb     adv    .     det   adj   verb   adv      adp   noun  verb  prt   det   noun  conj  adp   det   noun  adp   adj  <br/> adp   det   adj     .     verb       noun  .<br/>                 2. HMM  -164.05 -216.59 adp   det   adj   noun    .     noun   verb     adv    .     det   noun  verb   adv      adp   noun  verb  prt   det   noun  conj  adp   det   noun  adp   noun <br/> adp   det   adj     .     verb       noun  .<br/>          3. Confidence                  1.0   1.0   1.0   0.98    1.0   1.0    1.0      1.0    1.0   1.0   0.61  0.8    1.0      0.96  1.0   1.0   0.99  1.0   1.0   1.0   1.0   1.0   0.99  0.86  0.79 <br/> 1.0   1.0   1.0     1.0   1.0        1.0   1.0<br/><br/>==> So far scored 3 sentences with 70 words.<br/>                   Words correct:     Sentences correct:<br/>   0. Ground truth:      100.00%              100.00%<br/>         1. Simple:       91.43%               33.33%<br/>            2. HMM:       94.29%               33.33%** |
| **Words correct:     Sentences correct:<br/>   0. Ground truth:      100.00%              100.00%<br/>         1. Simple:       89.80%               25.00%<br/>            2. HMM:       93.88%               25.00%<br/>----<br/>                          Simple     HMM but   the   murderer to    whom  he    clung had   a     tremendous advantage .    <br/>        0. Ground truth   -56.02  -76.64 conj  det   noun     adp   pron  pron  verb  verb  det   adj        noun      .<br/>              1. Simple   -54.04  -79.70 conj  det   noun     prt   pron  pron  verb  verb  det   adj        noun      .<br/>                 2. HMM   -56.02  -76.64 conj  det   noun     adp   pron  pron  verb  verb  det   adj        noun      .<br/>          3. Confidence                  0.99  1.0   1.0      1.0   1.0   1.0   1.0   1.0   0.95  1.0        1.0       1.0<br/><br/>==> So far scored 5 sentences with 110 words.<br/>                   Words correct:     Sentences correct:<br/>   0. Ground truth:      100.00%              100.00%<br/>         1. Simple:       90.00%               20.00%<br/>            2. HMM:       94.55%               40.00%** |